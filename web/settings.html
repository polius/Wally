<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Wally | Settings</title>
  <link rel="icon" type="image/png" href="assets/wally.png">
  <meta name="robots" content="index,follow" />
  <meta name="description" content="A lightweight, self-hosted expense tracker that makes it easy to manage your finances." />
  <meta property="author" content="Pol Alzina" />
  <meta property="og:title" content="Wally" />
  <meta property="og:description" content="A lightweight, self-hosted expense tracker that makes it easy to manage your finances." />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="assets/wally.png" />
  <!-- CSS -->
  <link href="css/vendors/bootstrap.min.css" rel="stylesheet">
  <link href="css/vendors/tom-select.min.css" rel="stylesheet">
  <link href="css/vendors/tom-select.bootstrap5.min.css" rel="stylesheet">
  <link href="css/settings.css" rel="stylesheet">
  <!-- JS -->
  <script src="js/vendors/bootstrap.bundle.min.js" defer></script>
  <script src="js/vendors/bootstrap-show-toast.js" defer></script>
  <script src="js/vendors/ag-grid-community.min.noStyle.js" defer></script>
  <script src="js/vendors/tom-select.complete.min.js" defer></script>
  <script src="js/vendors/papaparse.min.js" defer></script>
  <script src="js/i18n.js"></script>


  <script>
    (function() {
      const theme = localStorage.getItem('theme') || 'system';
      const systemPrefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
      if (theme === 'light' || (theme === 'system' && !systemPrefersDark)) {
        document.documentElement.setAttribute('data-bs-theme', 'light');
      }
      else {
        document.documentElement.setAttribute('data-bs-theme', 'dark');
      }
    })();
  </script>
</head>

<body data-i18n-document-title="settings.title">
  <!-- Header -->
  <header>
    <div class="container">
      <nav class="navbar navbar-expand-lg navbar-light">
        <a class="navbar-brand d-flex align-items-center" style="margin-left:10px; margin-right:30px" href="/">
          <img src="assets/wally.png" alt="Wally" width="50" height="50" style="margin-bottom: 5px; margin-right: 8px;">
          <span style="font-size: 1.8rem; font-weight:600;">Wally</span>
        </a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav">
            <li class="nav-item" style="margin-left: 10px"><a class="nav-link" href="/" data-i18n="nav.dashboards">Dashboards</a></li>
            <li class="nav-item" style="margin-left: 10px"><a class="nav-link" href="transactions" data-i18n="nav.transactions">Transactions</a></li>
            <li class="nav-item" style="margin-left: 10px"><a class="nav-link active" href="settings" style="font-weight: 500" data-i18n="nav.settings">Settings</a></li>
          </ul>
          <ul id="logoutButton" class="navbar-nav ms-auto" style="display: none;">
            <li class="nav-item nav-link" style="margin-left: 10px; cursor: pointer;" title="Logout" data-i18n-title="nav.logout_title" onclick="logout()">
              <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="var(--pill-color)" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                <path d="M14 8v-2a2 2 0 0 0 -2 -2h-7a2 2 0 0 0 -2 2v12a2 2 0 0 0 2 2h7a2 2 0 0 0 2 -2v-2" />
                <path d="M9 12h12l-3 -3" />
                <path d="M18 15l3 -3" />
              </svg>
            </li>
          </ul>
        </div>
      </nav>
    </div>
  </header>

  <!-- Main Content -->
  <main class="container mb-4">
    <div style="display: flex; align-items: center; justify-content: center; gap: 10px; margin-top: 15px; font-size: 0.9rem; color: var(--pill-color); font-weight: 300;">
      <a href="https://github.com/polius/Wally/releases/latest" target="_blank" style="text-decoration: none; color: inherit;">
        <span data-i18n="settings.version">Version:</span> <span id="version" style="text-decoration: underline; font-weight: 400;"></span>
      </a>
      <span style="padding-left: 3px; padding-right:3px; font-weight: 100">|</span>
      <a href="/api/docs" target="_blank" style="text-decoration: underline; color: inherit; font-weight: 400;" data-i18n="settings.api_docs">
        API Docs
      </a>
    </div>
    <div class="row">
      <div class="col-md-6 mt-3">
        <div class="card h-100">
          <div class="card-header" style="font-weight: 500" data-i18n="settings.categories.title">Categories</div>
          <div class="card-body d-flex flex-column" style="height: 100%;">
            <div id="categoryBadges" class="flex-grow-1"></div>
            <form id="categoryForm" class="modal-content mt-2" onsubmit="addCategory(event)">
              <div class="input-group">
                <input type="text" class="form-control" name="name" placeholder="Add new category" data-i18n-placeholder="settings.categories.placeholder" style="font-size: 0.9rem;" required />
                <button class="btn btn-primary" type="submit" style="font-size: 0.9rem;" data-i18n="settings.categories.add">Add</button>
              </div>
            </form>
          </div>
        </div>
      </div>
      <div class="col-md-6 mt-3">
        <div class="card h-100">
          <div class="card-header" style="font-weight: 500" data-i18n="settings.tags.title">Tags</div>
          <div class="card-body d-flex flex-column" style="height: 100%;">
            <div id="tagBadges" class="flex-grow-1"></div>
            <form id="tagForm" class="modal-content mt-2" onsubmit="addTag(event)">
              <div class="input-group">
                <input type="text" class="form-control" name="name" placeholder="Add new tag" data-i18n-placeholder="settings.tags.placeholder" style="font-size: 0.9rem;" required />
                <button class="btn btn-primary" type="submit" style="font-size: 0.9rem;" data-i18n="settings.tags.add">Add</button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-md-6 mt-3">
        <div class="card h-100">
          <div class="card-header" style="font-weight: 500" data-i18n="settings.theme.title">Theme</div>
          <div class="card-body">
            <p class="card-text" style="font-size: 0.9rem" data-i18n="settings.theme.description">Select the theme to be used.</p>
            <select class="form-select" id="themeSelect" style="font-size: 0.9rem" onchange="changeTheme(event)">
              <option value="system" data-i18n="settings.theme.system">System Default</option>
              <option value="light" data-i18n="settings.theme.light">Light</option>
              <option value="dark" data-i18n="settings.theme.dark">Dark</option>
            </select>
          </div>
        </div>
      </div>
      <div class="col-md-6 mt-3">
        <div class="card h-100">
          <div class="card-header d-flex align-items-center" style="font-weight: 500">
            <span data-i18n="settings.currency.title">Currency</span>
            <button class="btn btn-sm btn-primary ms-auto" style="white-space: nowrap" data-bs-toggle="modal" data-bs-target="#currencyModal" data-i18n="settings.currency.manage">Manage</button>
          </div>
          <div class="card-body">
            <p class="card-text" style="font-size: 0.9rem; margin-bottom: 0.5rem" data-i18n="settings.currency.description">Select the currency to be used for transactions.</p>
            <select class="form-select" id="currencySelect" style="font-size: 0.9rem; margin-bottom: 0.75rem" onchange="changeCurrency(event)"></select>
            <p class="card-text" style="font-size: 0.9rem; margin-bottom: 0.5rem" data-i18n="settings.currency.position">Symbol position:</p>
            <div class="btn-group w-100" role="group">
              <input type="radio" class="btn-check" name="currencyPosition" id="positionLeft" value="left" autocomplete="off" onchange="changeCurrencyPosition(event)">
              <label class="btn btn-outline-primary" for="positionLeft" id="positionLeftLabel" style="font-size: 0.9rem">$100</label>
              
              <input type="radio" class="btn-check" name="currencyPosition" id="positionRight" value="right" autocomplete="off" onchange="changeCurrencyPosition(event)">
              <label class="btn btn-outline-primary" for="positionRight" id="positionRightLabel" style="font-size: 0.9rem">100$</label>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-md-6 mt-3">
        <div class="card h-100">
          <div class="card-header" style="font-weight: 500" data-i18n="settings.language.title">Language</div>
          <div class="card-body">
            <p class="card-text" style="font-size: 0.9rem" data-i18n="settings.language.description">Select your preferred language.</p>
            <select class="form-select" id="languageSelect" style="font-size: 0.9rem" onchange="changeLanguage(event)">
              <option value="ar">العربية</option>
              <option value="ca">Català</option>
              <option value="zh">中文</option>
              <option value="de">Deutsch</option>
              <option value="en">English</option>
              <option value="es">Español</option>
              <option value="fr">Français</option>
              <option value="hi">हिन्दी</option>
              <option value="it">Italiano</option>
              <option value="ja">日本語</option>
              <option value="ko">한국어</option>
              <option value="pt">Português</option>
              <option value="ru">Русский</option>
            </select>
          </div>
        </div>
      </div>
      <div class="col-md-6 mt-3">
        <div class="card h-100">
          <div class="card-header" style="font-weight: 500">
            <span data-i18n="settings.login.title">Login</span>
          </div>
          <div class="card-body">
            <p class="card-text mb-3" style="font-size: 0.9rem" data-i18n="settings.login.description">Enable the login page. Off allows access without signing in.</p>
            <button class="btn btn-primary" id="loginEnableBtn" style="min-width: 120px; font-size: 0.9rem; margin-right: 1px; display: none;" data-bs-toggle="modal" data-bs-target="#loginModalEnable" onclick="enableLogin()" data-i18n="settings.login.enable">Enable Login</button>
            <button class="btn btn-danger" id="loginDisableBtn" style="min-width: 120px; font-size: 0.9rem; margin-right: 1px; display: none;" data-bs-toggle="modal" data-bs-target="#loginModalDisable" data-i18n="settings.login.disable">Disable Login</button>
            <button class="btn btn-primary" id="loginChangeBtn" style="min-width: 180px; font-size: 0.9rem; display: none;"  data-bs-toggle="modal" data-bs-target="#loginModalChange" onclick="changeLogin()" data-i18n="settings.login.change">Change Password</button>
          </div>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-md-12 mt-3">
        <div class="card h-100">
          <div class="card-header" style="font-weight: 500" data-i18n="settings.import_export.title">Import / Export Transactions</div>
          <div class="card-body">
            <p class="card-text" style="font-size: 0.9rem;" data-i18n="settings.import_export.description">Export or import transactions quickly using CSV files.</p>
            <button class="btn btn-sm btn-primary" style="margin-right: 1px; min-width: 140px; padding-left: 12px; padding-right: 12px;" onclick="exportToCSV()">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512" width="12" height="12" fill="white" style="margin-right: 3px">
                <path d="M169.4 502.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 402.7 224 32c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 370.7-105.4-105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z"/>
              </svg>
              <span data-i18n="settings.import_export.export">Export to CSV</span>
            </button>
            <input type="file" id="csvInput" accept=".csv" style="display:none" onchange="importFromCSV(event)">
            <button class="btn btn-sm btn-primary" style="min-width: 140px; padding-left: 12px; padding-right: 12px;" onclick="csvInput.click()">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512" width="12" height="12" fill="white" style="margin-right: 3px">
                <path d="M214.6 17.4c-12.5-12.5-32.8-12.5-45.3 0l-160 160c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L160 117.3 160 488c0 17.7 14.3 32 32 32s32-14.3 32-32l0-370.7 105.4 105.4c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3l-160-160z"/>
              </svg>
              <span data-i18n="settings.import_export.import">Import from CSV</span>
            </button>
          </div>
        </div>
      </div>
    </div>

    <div class="card mt-3">
      <div class="card-header d-flex align-items-center" style="font-weight: 500">
        <span data-i18n="settings.recurring.title">Recurring Transactions</span>
        <button class="btn btn-sm btn-success ms-auto" data-i18n-title="settings.recurring.add_tooltip" title="Add new recurring transaction" style="width: 80px" data-bs-toggle="modal" data-bs-target="#recurringModal" onclick="addRecurring()">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" width="12" height="12" fill="white" style="margin-right: 3px; padding-bottom: 2px">
            <path d="M256 64c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 160-160 0c-17.7 0-32 14.3-32 32s14.3 32 32 32l160 0 0 160c0 17.7 14.3 32 32 32s32-14.3 32-32l0-160 160 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-160 0 0-160z"/>
          </svg>
          <span data-i18n="settings.recurring.add_btn">Add</span>
        </button>
      </div>
      <div class="card-body">
        <!-- Grid Filter -->
        <div class="mb-2">
          <input type="text" class="form-control" id="searchInput" placeholder="Search..." data-i18n-placeholder="settings.recurring.search_placeholder" style="font-size: 0.9rem;" oninput="onFilterTextBoxChanged()" />
        </div>
        <!-- AG Grid Table -->
        <div id="myGrid" style="height: 500px;"></div>
        <!-- Row count -->
        <div id="rowCount" class="mt-3" style="text-align: center; font-size: 0.85rem; font-weight: 600;"></div>
      </div>
    </div>
  </main>

  <!-- Category Modal Actions -->
  <div class="modal fade" id="categoryModalActions" tabindex="-1" aria-labelledby="categoryModalActionsLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="categoryModalActionsLabel">
            <strong id="categoryModalActionsName"></strong>
          </h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="d-flex gap-2 justify-content-center">
            <button type="button" class="btn btn-primary" style="flex: 1;" onclick="openEditCategoryModal()">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" width="14" height="14" fill="white" style="margin-right: 6px; vertical-align: middle; margin-bottom: 2px">
                <path d="M471.6 21.7c-21.9-21.9-57.3-21.9-79.2 0L368 46.1 465.9 144 490.3 119.6c21.9-21.9 21.9-57.3 0-79.2L471.6 21.7zm-299.2 220c-6.1 6.1-10.8 13.6-13.5 21.9l-29.6 88.8c-2.9 8.6-.6 18.1 5.8 24.6s15.9 8.7 24.6 5.8l88.8-29.6c8.2-2.7 15.7-7.4 21.9-13.5L432 177.9 334.1 80 172.4 241.7zM96 64C43 64 0 107 0 160L0 416c0 53 43 96 96 96l256 0c53 0 96-43 96-96l0-96c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 96c0 17.7-14.3 32-32 32L96 448c-17.7 0-32-14.3-32-32l0-256c0-17.7 14.3-32 32-32l96 0c17.7 0 32-14.3 32-32s-14.3-32-32-32L96 64z"/>
              </svg>
              <span data-i18n="common.edit">Edit</span>
            </button>
            <button type="button" class="btn btn-danger" style="flex: 1;" onclick="openDeleteCategoryModal()">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" width="14" height="14" fill="white" style="margin-right: 6px; vertical-align: middle; margin-bottom: 2px">
                <path d="M136.7 5.9C141.1-7.2 153.3-16 167.1-16l113.9 0c13.8 0 26 8.8 30.4 21.9L320 32 416 32c17.7 0 32 14.3 32 32s-14.3 32-32 32L32 96C14.3 96 0 81.7 0 64S14.3 32 32 32l96 0 8.7-26.1zM32 144l384 0 0 304c0 35.3-28.7 64-64 64L96 512c-35.3 0-64-28.7-64-64l0-304zm88 64c-13.3 0-24 10.7-24 24l0 192c0 13.3 10.7 24 24 24s24-10.7 24-24l0-192c0-13.3-10.7-24-24-24zm104 0c-13.3 0-24 10.7-24 24l0 192c0 13.3 10.7 24 24 24s24-10.7 24-24l0-192c0-13.3-10.7-24-24-24zm104 0c-13.3 0-24 10.7-24 24l0 192c0 13.3 10.7 24 24 24s24-10.7 24-24l0-192c0-13.3-10.7-24-24-24z"/>
              </svg>
              <span data-i18n="common.delete">Delete</span>
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Category Modal Edit -->
  <div class="modal fade" id="categoryModalEdit" tabindex="-1" aria-labelledby="categoryModalEditLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <form class="modal-content" onsubmit="editCategorySubmit(event)">
        <div class="modal-header">
          <h5 class="modal-title" id="categoryModalEditLabel" data-i18n="settings.categories.edit_title">Edit Category</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <label for="categoryEditInput" class="form-label" data-i18n="settings.categories.name_label">Category Name</label>
          <input type="text" class="form-control" id="categoryEditInput" name="name" placeholder="Enter new name" data-i18n-placeholder="common.enter_new_name" required />
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" style="min-width: 120px" data-i18n="common.cancel">Cancel</button>
          <button type="submit" class="btn btn-primary" style="min-width: 120px" data-i18n="common.update">Update</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Category Modal Delete -->
  <div class="modal fade" id="categoryModalDelete" tabindex="-1" aria-labelledby="categoryModalDeleteLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <form class="modal-content" onsubmit="deleteCategorySubmit(event)">
        <div class="modal-header">
          <h5 class="modal-title" id="categoryModalDeleteLabel" data-i18n="settings.categories.delete_title">Delete Category</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <p><span data-i18n="settings.categories.delete_confirm">Are you sure you want to delete the category</span> <strong id="categoryModalDeleteName"></strong>?</p>
          <div class="alert alert-light mb-0" style="font-size: 0.9rem; border: 1px solid #dee2e6;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" width="14" height="14" fill="#6c757d" style="margin-right: 6px; vertical-align: middle; margin-bottom: 2px">
              <path d="M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM216 336l24 0 0-64-24 0c-13.3 0-24-10.7-24-24s10.7-24 24-24l48 0c13.3 0 24 10.7 24 24l0 88 8 0c13.3 0 24 10.7 24 24s-10.7 24-24 24l-80 0c-13.3 0-24-10.7-24-24s10.7-24 24-24zm40-208a32 32 0 1 1 0 64 32 32 0 1 1 0-64z"/>
            </svg>
            <span data-i18n="settings.categories.delete_warning">This will only work if there are no transactions using this category.</span>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" style="width: 120px" data-i18n="common.cancel">Cancel</button>
          <button type="submit" class="btn btn-danger" style="width: 120px" data-i18n="common.delete">Delete</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Tag Modal Actions -->
  <div class="modal fade" id="tagModalActions" tabindex="-1" aria-labelledby="tagModalActionsLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="tagModalActionsLabel">
            <strong id="tagModalActionsName"></strong>
          </h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="d-flex gap-2 justify-content-center">
            <button type="button" class="btn btn-primary" style="flex: 1;" onclick="openEditTagModal()">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" width="14" height="14" fill="white" style="margin-right: 6px; vertical-align: middle; margin-bottom: 2px">
                <path d="M471.6 21.7c-21.9-21.9-57.3-21.9-79.2 0L368 46.1 465.9 144 490.3 119.6c21.9-21.9 21.9-57.3 0-79.2L471.6 21.7zm-299.2 220c-6.1 6.1-10.8 13.6-13.5 21.9l-29.6 88.8c-2.9 8.6-.6 18.1 5.8 24.6s15.9 8.7 24.6 5.8l88.8-29.6c8.2-2.7 15.7-7.4 21.9-13.5L432 177.9 334.1 80 172.4 241.7zM96 64C43 64 0 107 0 160L0 416c0 53 43 96 96 96l256 0c53 0 96-43 96-96l0-96c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 96c0 17.7-14.3 32-32 32L96 448c-17.7 0-32-14.3-32-32l0-256c0-17.7 14.3-32 32-32l96 0c17.7 0 32-14.3 32-32s-14.3-32-32-32L96 64z"/>
              </svg>
              <span data-i18n="common.edit">Edit</span>
            </button>
            <button type="button" class="btn btn-danger" style="flex: 1;" onclick="openDeleteTagModal()">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" width="14" height="14" fill="white" style="margin-right: 6px; vertical-align: middle; margin-bottom: 2px">
                <path d="M136.7 5.9C141.1-7.2 153.3-16 167.1-16l113.9 0c13.8 0 26 8.8 30.4 21.9L320 32 416 32c17.7 0 32 14.3 32 32s-14.3 32-32 32L32 96C14.3 96 0 81.7 0 64S14.3 32 32 32l96 0 8.7-26.1zM32 144l384 0 0 304c0 35.3-28.7 64-64 64L96 512c-35.3 0-64-28.7-64-64l0-304zm88 64c-13.3 0-24 10.7-24 24l0 192c0 13.3 10.7 24 24 24s24-10.7 24-24l0-192c0-13.3-10.7-24-24-24zm104 0c-13.3 0-24 10.7-24 24l0 192c0 13.3 10.7 24 24 24s24-10.7 24-24l0-192c0-13.3-10.7-24-24-24zm104 0c-13.3 0-24 10.7-24 24l0 192c0 13.3 10.7 24 24 24s24-10.7 24-24l0-192c0-13.3-10.7-24-24-24z"/>
              </svg>
              <span data-i18n="common.delete">Delete</span>
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Tag Modal Edit -->
  <div class="modal fade" id="tagModalEdit" tabindex="-1" aria-labelledby="tagModalEditLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <form class="modal-content" onsubmit="editTagSubmit(event)">
        <div class="modal-header">
          <h5 class="modal-title" id="tagModalEditLabel" data-i18n="settings.tags.edit_title">Edit Tag</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <label for="tagEditInput" class="form-label" data-i18n="settings.tags.name_label">Tag Name</label>
          <input type="text" class="form-control" id="tagEditInput" name="name" placeholder="Enter new name" data-i18n-placeholder="common.enter_new_name" required />
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" style="min-width: 120px" data-i18n="common.cancel">Cancel</button>
          <button type="submit" class="btn btn-primary" style="min-width: 120px" data-i18n="common.update">Update</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Tag Modal Delete -->
  <div class="modal fade" id="tagModalDelete" tabindex="-1" aria-labelledby="tagModalDeleteLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <form class="modal-content" onsubmit="deleteTagSubmit(event)">
        <div class="modal-header">
          <h5 class="modal-title" id="tagModalDeleteLabel" data-i18n="settings.tags.delete_title">Delete Tag</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <p><span data-i18n="settings.tags.delete_confirm">Are you sure you want to delete the tag</span> <strong id="tagModalDeleteName"></strong>?</p>
          <div class="alert alert-light mb-0" style="font-size: 0.9rem; border: 1px solid #dee2e6;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" width="14" height="14" fill="#6c757d" style="margin-right: 6px; vertical-align: middle; margin-bottom: 2px">
              <path d="M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM216 336l24 0 0-64-24 0c-13.3 0-24-10.7-24-24s10.7-24 24-24l48 0c13.3 0 24 10.7 24 24l0 88 8 0c13.3 0 24 10.7 24 24s-10.7 24-24 24l-80 0c-13.3 0-24-10.7-24-24s10.7-24 24-24zm40-208a32 32 0 1 1 0 64 32 32 0 1 1 0-64z"/>
            </svg>
            <span data-i18n="settings.tags.delete_warning">This tag will be removed from all transactions.</span>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" style="width: 120px" data-i18n="common.cancel">Cancel</button>
          <button type="submit" class="btn btn-danger" style="width: 120px" data-i18n="common.delete">Delete</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Currency Management Modal -->
  <div class="modal fade" id="currencyModal" tabindex="-1" aria-labelledby="currencyModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="currencyModalLabel" data-i18n="settings.currency.manage_title">Manage Currencies</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <input type="text" class="form-control mb-3" id="currencySearch" placeholder="Search currencies..." data-i18n-placeholder="settings.currency.search_placeholder" style="font-size: 0.9rem;" oninput="filterCurrencyList()">
          <div style="max-height: 400px; overflow-y: auto; border: 1px solid var(--bs-border-color); border-radius: 8px;">
            <table class="table table-hover align-middle mb-0" style="font-size: 0.9rem;">
              <thead style="position: sticky; top: 0; background: var(--bs-secondary-bg); z-index: 10; border-bottom: 2px solid var(--bs-border-color);">
                <tr>
                  <th style="width: 40%; padding: 12px 16px; font-weight: 600; font-size: 0.85rem; text-transform: uppercase; letter-spacing: 0.5px; color: var(--bs-secondary-color);" data-i18n="settings.currency.code">Code</th>
                  <th style="width: 35%; padding: 12px 16px; font-weight: 600; font-size: 0.85rem; text-transform: uppercase; letter-spacing: 0.5px; color: var(--bs-secondary-color);" data-i18n="settings.currency.symbol">Symbol</th>
                  <th style="width: 25%; padding: 12px 16px; text-align: center; font-weight: 600; font-size: 0.85rem; text-transform: uppercase; letter-spacing: 0.5px; color: var(--bs-secondary-color);" data-i18n="settings.currency.actions">Actions</th>
                </tr>
              </thead>
              <tbody id="currencyTableBody"></tbody>
            </table>
          </div>
          <hr>
          <form id="currencyAddForm" onsubmit="addCurrencySubmit(event)">
            <div class="input-group">
              <input type="text" class="form-control" name="name" placeholder="Code" data-i18n-placeholder="settings.currency.code" maxlength="10" style="font-size: 0.9rem;" required />
              <input type="text" class="form-control" name="symbol" placeholder="Symbol" data-i18n-placeholder="settings.currency.symbol" maxlength="10" style="font-size: 0.9rem;" required />
              <button class="btn btn-success" type="submit" style="font-size: 0.9rem;" data-i18n="settings.currency.add_currency">Add Currency</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- Currency Edit Modal -->
  <div class="modal fade" id="currencyEditModal" tabindex="-1" aria-labelledby="currencyEditModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <form class="modal-content" onsubmit="editCurrencySubmit(event)">
        <div class="modal-header">
          <h5 class="modal-title" id="currencyEditModalLabel" data-i18n="settings.currency.edit_title">Edit Currency</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="row g-2">
            <div class="col">
              <label for="currencyEditName" class="form-label" data-i18n="settings.currency.code">Code</label>
              <input type="text" class="form-control" id="currencyEditName" name="name" maxlength="10" required />
            </div>
            <div class="col">
              <label for="currencyEditSymbol" class="form-label" data-i18n="settings.currency.symbol">Symbol</label>
              <input type="text" class="form-control" id="currencyEditSymbol" name="symbol" maxlength="10" required />
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" onclick="cancelCurrencyEdit()" style="min-width: 100px" data-i18n="common.cancel">Cancel</button>
          <button type="submit" class="btn btn-primary" style="min-width: 100px" data-i18n="common.update">Update</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Recurring Modal (Add and Edit) -->
  <div class="modal fade" id="recurringModal" tabindex="-1" aria-labelledby="recurringModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <form id="recurringForm" class="modal-content" onsubmit="submitRecurring(event)">
        <div class="modal-header">
          <h5 class="modal-title" id="recurringModalLabel">Add Recurring Transaction</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">

          <!-- Name -->
          <div class="mb-3">
            <label for="nameInput" class="form-label" data-i18n="settings.recurring.name">Name</label>
            <input type="text" class="form-control" id="nameInput" name="name" placeholder="Enter name" data-i18n-placeholder="settings.recurring.name_placeholder" required />
          </div>

          <!-- Category -->
          <div class="mb-3">
            <label for="categorySelect" class="form-label" data-i18n="settings.recurring.category">Category</label>
            <select class="form-select" id="categorySelect" name="category" required></select>
          </div>

          <!-- Tags -->
          <div class="mb-3">
            <label class="form-label" data-i18n="settings.recurring.tags">Tags</label>
            <input id="tagsInput" name="tags" type="text" class="form-control" value="" placeholder="Add a tag and press Enter" data-i18n-placeholder="settings.recurring.tags_placeholder" autocomplete="off">
          </div>

          <!-- Amount -->
          <div class="mb-3">
            <label for="amountInput" class="form-label" data-i18n="settings.recurring.amount">Amount</label>
            <input type="text" inputmode="decimal" class="form-control" id="amountInput" name="amount" min="0.01" step="0.01" required />
          </div>

          <!-- Type -->
          <div class="mb-3">
            <label for="typeSelect" class="form-label" data-i18n="settings.recurring.type">Type</label>
            <select class="form-select" id="typeSelect" name="type" required>
              <option value="expense" data-i18n="settings.recurring.type_expense">Expense</option>
              <option value="income" data-i18n="settings.recurring.type_income">Income</option>
            </select>
          </div>

          <div class="row">
            <!-- Start Date -->
            <div class="col-6 mb-3">
              <label for="startDateInput" class="form-label" data-i18n="settings.recurring.start_date">Start Date</label>
              <input type="date" class="form-control" id="startDateInput" name="startDate" required />
            </div>
            <!-- End Date -->
            <div class="col-6 mb-3">
              <label for="endDateInput" class="form-label" data-i18n="settings.recurring.end_date">End Date</label>
              <input type="date" class="form-control" id="endDateInput" name="endDate" required />
            </div>
          </div>

          <!-- Frequency -->
          <div class="mb-1">
            <label for="frequencySelect" class="form-label" data-i18n="settings.recurring.frequency">Frequency</label>
            <select class="form-select" id="frequencySelect" name="frequency" required>
              <option value="" disabled selected data-i18n="settings.recurring.frequency_placeholder">Select frequency</option>
              <option value="daily" data-i18n="settings.recurring.frequency_daily">Daily</option>
              <option value="weekly" data-i18n="settings.recurring.frequency_weekly">Weekly</option>
              <option value="monthly" data-i18n="settings.recurring.frequency_monthly">Monthly</option>
              <option value="yearly" data-i18n="settings.recurring.frequency_yearly">Yearly</option>
            </select>
          </div>

          <!-- Apply To -->
          <div id="recurringModalApplyTo" class="card mt-3" style="display: none">
            <div class="card-body">
              <p class="mb-3" data-i18n="settings.recurring.apply_to">Apply changes to:</p>
              <div class="form-check mb-2">
                <input class="form-check-input" type="radio" name="applyTo" value="future" id="recurringEditRadioFuture" checked>
                <label class="form-check-label" for="recurringEditRadioFuture" data-i18n="settings.recurring.apply_future">
                  Future transactions only
                </label>
                <div class="form-text" data-i18n="settings.recurring.apply_future_hint">Past ones will stay as they are.</div>
              </div>

              <div class="form-check">
                <input class="form-check-input" type="radio" name="applyTo" value="all" id="recurringEditRadioAll">
                <label class="form-check-label" for="recurringEditRadioAll" data-i18n="settings.recurring.apply_all">
                  All transactions
                </label>
                <div class="form-text" data-i18n="settings.recurring.apply_all_hint">Past and future occurrences will be updated.</div>
              </div>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" style="min-width: 120px" data-i18n="common.cancel">Cancel</button>
          <button type="submit" class="btn btn-success" id="modalSubmitButton" style="min-width: 120px" data-i18n="settings.recurring.add_btn">Add</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Recurring Modal Delete -->
  <div class="modal fade" id="recurringModalDelete" tabindex="-1" aria-labelledby="recurringModalDeleteLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <form class="modal-content" onsubmit="submitRecurring(event)">
        <div class="modal-header">
          <h5 class="modal-title" id="recurringModalDeleteLabel" data-i18n="settings.recurring.modal_delete_title">Delete Recurring Transaction</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <span data-i18n="settings.recurring.delete_confirm">Are you sure you want to delete this recurring transaction?</span>
          <div id="recurringModalDeleteApplyTo" class="card mt-3">
            <div class="card-body">
              <p class="mb-3" data-i18n="settings.recurring.apply_to">Apply changes to:</p>
              <div class="form-check mb-2">
                <input class="form-check-input" type="radio" name="applyTo" value="future" id="recurringDeleteRadioFuture" checked>
                <label class="form-check-label" for="recurringDeleteRadioFuture" data-i18n="settings.recurring.apply_future">
                  Future transactions only
                </label>
                <div class="form-text" data-i18n="settings.recurring.apply_future_hint">Past ones will stay as they are.</div>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="applyTo" value="all" id="recurringDeleteRadioAll">
                <label class="form-check-label" for="recurringDeleteRadioAll" data-i18n="settings.recurring.apply_all">
                  All transactions
                </label>
                <div class="form-text" data-i18n="settings.recurring.apply_all_hint">Past and future occurrences will be updated.</div>
              </div>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" style="min-width: 120px" data-i18n="common.cancel">Cancel</button>
          <button type="submit" class="btn btn-danger" style="min-width: 120px" data-i18n="common.delete">Delete</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Login Page Enable -->
  <div id="loginModalEnable" class="modal fade">
    <div class="modal-dialog modal-dialog-centered">
      <form id="loginFormEnable" class="modal-content" onsubmit="loginSubmit(event, 'enable')">
        <div class="modal-header">
          <h5 class="modal-title" data-i18n="settings.login.enable_title">Enable Login Page</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <label for="loginEnablePasswordInput" class="form-label" data-i18n="settings.login.password_label">Password</label>
          <div class="input-group">
            <input type="password" class="form-control" id="loginEnablePasswordInput" name="password" placeholder="Enter a password" data-i18n-placeholder="settings.login.password_placeholder" required />
            <button id="loginEnablePasswordShow" class="btn btn-outline-secondary" type="button" data-i18n-title="settings.login.show_password" title="Show password" onclick="loginEnablePasswordShow.style.display = 'none'; loginEnablePasswordHide.style.display = 'block'; loginEnablePasswordInput.type = 'text'">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512" width="16" height="16" fill="currentColor" style="margin-bottom: 2px">
                <path d="M41-24.9c-9.4-9.4-24.6-9.4-33.9 0S-2.3-.3 7 9.1l528 528c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-96.4-96.4c2.7-2.4 5.4-4.8 8-7.2 46.8-43.5 78.1-95.4 93-131.1 3.3-7.9 3.3-16.7 0-24.6-14.9-35.7-46.2-87.7-93-131.1-47.1-43.7-111.8-80.6-192.6-80.6-56.8 0-105.6 18.2-146 44.2L41-24.9zM204.5 138.7c23.5-16.8 52.4-26.7 83.5-26.7 79.5 0 144 64.5 144 144 0 31.1-9.9 59.9-26.7 83.5l-34.7-34.7c12.7-21.4 17-47.7 10.1-73.7-13.7-51.2-66.4-81.6-117.6-67.9-8.6 2.3-16.7 5.7-24 10l-34.7-34.7zM325.3 395.1c-11.9 3.2-24.4 4.9-37.3 4.9-79.5 0-144-64.5-144-144 0-12.9 1.7-25.4 4.9-37.3L69.4 139.2c-32.6 36.8-55 75.8-66.9 104.5-3.3 7.9-3.3 16.7 0 24.6 14.9 35.7 46.2 87.7 93 131.1 47.1 43.7 111.8 80.6 192.6 80.6 37.3 0 71.2-7.9 101.5-20.6l-64.2-64.2z"/>
              </svg>
            </button>
            <button id="loginEnablePasswordHide" class="btn btn-outline-secondary" type="button" data-i18n-title="settings.login.hide_password" title="Hide password" style="display: none" onclick="loginEnablePasswordShow.style.display = 'block'; loginEnablePasswordHide.style.display = 'none'; loginEnablePasswordInput.type = 'password'">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512" width="16" height="16" fill="currentColor" style="margin-bottom: 2px">
                <path d="M288 32c-80.8 0-145.5 36.8-192.6 80.6-46.8 43.5-78.1 95.4-93 131.1-3.3 7.9-3.3 16.7 0 24.6 14.9 35.7 46.2 87.7 93 131.1 47.1 43.7 111.8 80.6 192.6 80.6s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1 3.3-7.9 3.3-16.7 0-24.6-14.9-35.7-46.2-87.7-93-131.1-47.1-43.7-111.8-80.6-192.6-80.6zM144 256a144 144 0 1 1 288 0 144 144 0 1 1 -288 0zm144-64c0 35.3-28.7 64-64 64-11.5 0-22.3-3-31.7-8.4-1 10.9-.1 22.1 2.9 33.2 13.7 51.2 66.4 81.6 117.6 67.9s81.6-66.4 67.9-117.6c-12.2-45.7-55.5-74.8-101.1-70.8 5.3 9.3 8.4 20.1 8.4 31.7z"/>
              </svg>
            </button>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" style="min-width: 120px" data-i18n="common.cancel">Cancel</button>
          <button type="submit" class="btn btn-primary" style="min-width: 120px" data-i18n="settings.login.enable_btn">Enable</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Login Page Disable -->
  <div id="loginModalDisable" class="modal fade">
    <div class="modal-dialog modal-dialog-centered">
      <form class="modal-content" onsubmit="loginSubmit(event, 'disable')">
        <div class="modal-header">
          <h5 class="modal-title" data-i18n="settings.login.disable_title">Disable Login Page</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body" data-i18n="settings.login.disable_confirm">
          Are you sure you want to disable the login page?
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" style="width: 120px" data-i18n="common.cancel">Cancel</button>
          <button type="submit" class="btn btn-danger" style="width: 120px" data-i18n="settings.login.disable_btn">Disable</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Login Page Change Password-->
  <div id="loginModalChange" class="modal fade">
    <div class="modal-dialog modal-dialog-centered">
      <form id="loginFormChange" class="modal-content" onsubmit="loginSubmit(event, 'change')">
        <div class="modal-header">
          <h5 class="modal-title" data-i18n="settings.login.change_title">Change Password</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <label for="loginChangePasswordInput" class="form-label" data-i18n="settings.login.password_label">Password</label>
          <div class="input-group">
            <input type="password" class="form-control" id="loginChangePasswordInput" name="password" placeholder="Enter a password" data-i18n-placeholder="settings.login.password_placeholder" required />
            <button id="loginChangePasswordShow" class="btn btn-outline-secondary" type="button" data-i18n-title="settings.login.show_password" title="Show password" onclick="loginChangePasswordShow.style.display = 'none'; loginChangePasswordHide.style.display = 'block'; loginChangePasswordInput.type = 'text'">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512" width="16" height="16" fill="currentColor" style="margin-bottom: 2px">
                <path d="M41-24.9c-9.4-9.4-24.6-9.4-33.9 0S-2.3-.3 7 9.1l528 528c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-96.4-96.4c2.7-2.4 5.4-4.8 8-7.2 46.8-43.5 78.1-95.4 93-131.1 3.3-7.9 3.3-16.7 0-24.6-14.9-35.7-46.2-87.7-93-131.1-47.1-43.7-111.8-80.6-192.6-80.6-56.8 0-105.6 18.2-146 44.2L41-24.9zM204.5 138.7c23.5-16.8 52.4-26.7 83.5-26.7 79.5 0 144 64.5 144 144 0 31.1-9.9 59.9-26.7 83.5l-34.7-34.7c12.7-21.4 17-47.7 10.1-73.7-13.7-51.2-66.4-81.6-117.6-67.9-8.6 2.3-16.7 5.7-24 10l-34.7-34.7zM325.3 395.1c-11.9 3.2-24.4 4.9-37.3 4.9-79.5 0-144-64.5-144-144 0-12.9 1.7-25.4 4.9-37.3L69.4 139.2c-32.6 36.8-55 75.8-66.9 104.5-3.3 7.9-3.3 16.7 0 24.6 14.9 35.7 46.2 87.7 93 131.1 47.1 43.7 111.8 80.6 192.6 80.6 37.3 0 71.2-7.9 101.5-20.6l-64.2-64.2z"/>
              </svg>
            </button>
            <button id="loginChangePasswordHide" class="btn btn-outline-secondary" type="button" data-i18n-title="settings.login.hide_password" title="Hide password" style="display: none" onclick="loginChangePasswordShow.style.display = 'block'; loginChangePasswordHide.style.display = 'none'; loginChangePasswordInput.type = 'password'">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512" width="16" height="16" fill="currentColor" style="margin-bottom: 2px">
                <path d="M288 32c-80.8 0-145.5 36.8-192.6 80.6-46.8 43.5-78.1 95.4-93 131.1-3.3 7.9-3.3 16.7 0 24.6 14.9 35.7 46.2 87.7 93 131.1 47.1 43.7 111.8 80.6 192.6 80.6s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1 3.3-7.9 3.3-16.7 0-24.6-14.9-35.7-46.2-87.7-93-131.1-47.1-43.7-111.8-80.6-192.6-80.6zM144 256a144 144 0 1 1 288 0 144 144 0 1 1 -288 0zm144-64c0 35.3-28.7 64-64 64-11.5 0-22.3-3-31.7-8.4-1 10.9-.1 22.1 2.9 33.2 13.7 51.2 66.4 81.6 117.6 67.9s81.6-66.4 67.9-117.6c-12.2-45.7-55.5-74.8-101.1-70.8 5.3 9.3 8.4 20.1 8.4 31.7z"/>
              </svg>
            </button>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" style="width: 120px" data-i18n="common.cancel">Cancel</button>
          <button type="submit" class="btn btn-primary" style="width: 120px" data-i18n="settings.login.change_btn">Change</button>
        </div>
      </form>
    </div>
  </div>

  <script src="js/settings.js"></script>
</body>
</html>
